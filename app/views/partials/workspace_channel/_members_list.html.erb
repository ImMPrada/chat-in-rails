<%# locals: {
  workspace: @workspace,
  user: current_user,
  channel_members: @channel_members
} %>

<div class="flex
            flex-col
            with-shadow
            w-full
            bg-black
            row-start-1
            col-start-1"
>
  <div class="flex
              justify-start
              gap-4
              py-4
              pr-5
              pl-8
              with-shadow
              w-full
              h-[60px]"
  >
    <a
      class="block w-6 h-6 text-white text-center fill-white"
      href=<%= workspace_channels_path(workspace) %>
    >
      <%= render(Primer::Beta::Octicon.new(:"chevron-left", size: :medium)) %>
    </a>
    <h2 class="text-white text-noto-18-700">All channels</h2>
  </div>

  <h3 class="block pr-5 pl-8 mt-6 text-white text-noto-18-700">
    <%= workspace_channel.name.upcase %>
  </h3>

  <p class="block
            pr-5
            pl-8
            mt-4
            text-white
            text-noto-18-400
            break-word
            overflow-y-auto">
    <%= workspace_channel.description %>
  </p>

  <div class="w-full
              flex
              justify-between
              items-center
              gap-2
              pr-5
              pl-8
              mt-6
              mb-6"
  >
    <h3 class="text-white text-noto-18-700">
      MEMBERS
    </h3>
    <% if policy(@workspace).create_invitation? %>
      <div class="bg-black h-6 w-6 text-white hover:cursor-pointer">
        +
      </div>
    <% end %>
  </div>
</div>

<div class="w-full
            flex
            flex-col
            gap-5
            pb-6
            pr-5
            pl-8
            bg-black
            overflow-y-auto
            row-start-2
            col-start-1"
>
  <% channel_members.each do |member| %>
    <a
      class="block flex gap-7 relative"
      href=<%= workspace_user_path(workspace, member) %>
      data-turbo-frame="tool_sidebar"
      data-turbo-frame-loader="eager"
      data-controller="membercard channelSidebar"
      data-action="click->membercard#remove_new_message_signal click->channelSidebar#close"
    >
      <img
        src=<%= member.avatar_url %>
        class="block w-10 h-10 rounded-lg self-center"
      >
      <span class="block self-center text-noto-18-700 text-grey-soft">
        <%= member.username %>
      </span>

      <div
        class="absolute h-2 w-2 bg-red rounded-full hidden"
        id=<%="#{dom_id(user)}_#{dom_id(member)}_new_message_signal"%>
        data-membercard-target = "newMessageSignal"
      ></div>
    </a>
  <% end %>
</div>

<div class="w-full
            flex
            justify-between
            py-4
            pr-5
            pl-8
            with-shadow
            bg-black-dark
            h-full
            row-start-3
            col-start-1"
>
  <%= render(
    partial: 'partials/workspace_channel/current_user_bar',
    locals: {
      user:,
    }
  ) %>
</div>
